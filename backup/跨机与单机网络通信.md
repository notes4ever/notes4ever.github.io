## 单次跨机网络通信
![image](https://github.com/user-attachments/assets/55bf9000-90b7-43c9-9926-6d82092cb3b0)

## 本机IO不经过网卡
![image](https://github.com/user-attachments/assets/8952bab7-bd98-4b8d-8670-21ceec85770a)

## 跨机与本机特点对比

**192.x.x.x == 127.0.0.1 ==loopback==lo虚拟网卡**

**首先，本机IP（比如192.x.x.x）和127.0.0.1没有差别，都是走的环回设备lo。**

**其次，只要是本地网络，都不需要经过网卡，即使网卡拔了也可以正常使用本机网络。**

这是因为内核在设置IP的时候，把所有的本机IP都初始化到了local路由表里，类型写死了是RTN_LOCAL。所以后面的路由项选择的时候发现类型是RTN_LOCAL就会选择lo设备。

数据包在内核中是什么走向，和外网发送相比流程上有什么差别？

- 节约了驱动上的一些开销。发送数据不需要进入RingBuffer的驱动队列，直接把skb传给接收协议栈。
- 其他组件，包括系统调用、协议栈、设备子系统都经过了，甚至驱动程序也运行了，所以还是有一定的开销的。
- 如果想要再本机网络IO上绕开协议栈的开销，可以动用eBPF，用eBPF的sockmap和sk redirect可以达到真正不走协议栈的目的。

思考：单机比跨网到底快多少？如何控制变量对比？